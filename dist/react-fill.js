!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("ramda"),require("voca/chars"),require("voca/words"),require("react")):"function"==typeof define&&define.amd?define(["ramda","voca/chars","voca/words","react"],n):"object"==typeof exports?exports.ReactFill=n(require("ramda"),require("voca/chars"),require("voca/words"),require("react")):e.ReactFill=n(e.ramda,e["voca/chars"],e["voca/words"],e.react)}(this,function(__WEBPACK_EXTERNAL_MODULE_0__,__WEBPACK_EXTERNAL_MODULE_3__,__WEBPACK_EXTERNAL_MODULE_4__,__WEBPACK_EXTERNAL_MODULE_2__){return function(e){function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="/dist/",n(n.s=1)}([function(module,exports){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n//////////////////\n// WEBPACK FOOTER\n// external "ramda"\n// module id = 0\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%22ramda%22?')},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = __webpack_require__(2);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _ramda = __webpack_require__(0);\n\nvar _ramda2 = _interopRequireDefault(_ramda);\n\nvar _chars = __webpack_require__(3);\n\nvar _chars2 = _interopRequireDefault(_chars);\n\nvar _words = __webpack_require__(4);\n\nvar _words2 = _interopRequireDefault(_words);\n\nvar _keycode = __webpack_require__(5);\n\nvar _keycode2 = _interopRequireDefault(_keycode);\n\nvar _keycodes = __webpack_require__(6);\n\nvar _keycodes2 = _interopRequireDefault(_keycodes);\n\nvar _utils = __webpack_require__(7);\n\n__webpack_require__(8);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ReactFill = function (_React$Component) {\n  _inherits(ReactFill, _React$Component);\n\n  function ReactFill(props) {\n    _classCallCheck(this, ReactFill);\n\n    var _this = _possibleConstructorReturn(this, (ReactFill.__proto__ || Object.getPrototypeOf(ReactFill)).call(this, props));\n\n    _this.updateStateNewText(props);\n    return _this;\n  }\n\n  _createClass(ReactFill, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.refs[this.state.focusKey].focus();\n      this.intervalID = setInterval(function () {\n        var nextKey = (0, _utils.findNextKey)(_this2.keys, _this2.state.completeKeys);\n        if (nextKey) {\n          _this2.refs[nextKey].focus();\n        }\n      }, 200);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.text !== this.props.text) {\n        this.updateStateNewText(nextProps);\n      }\n    }\n  }, {\n    key: 'updateStateNewText',\n    value: function updateStateNewText(props) {\n      var tokens = (0, _words2.default)(props.text, /[^\\s]+/g);\n      var nbBlanks = Math.ceil(props.percentBlank * tokens.length);\n      var missingIndexes = (0, _utils.getRandoms)(nbBlanks, tokens.length);\n      var data = _ramda2.default.map(function (idx) {\n        return [idx + '-' + tokens[idx], { original: tokens[idx], value: '' }];\n      }, missingIndexes);\n\n      this.refs = {};\n      this.keys = _ramda2.default.map(function (idx) {\n        return idx + '-' + tokens[idx];\n      }, missingIndexes);\n      this.state = {\n        missingWords: _ramda2.default.fromPairs(data),\n        tokens: tokens,\n        focusKey: _ramda2.default.head(this.keys),\n        completeKeys: [],\n        points: 0\n      };\n      this.startTime = new Date().getTime();\n    }\n  }, {\n    key: 'completeWord',\n    value: function completeWord(newPoints, key) {\n      var completeAction = this.props.completeAction;\n      var _state = this.state,\n          points = _state.points,\n          completeKeys = _state.completeKeys;\n\n      var newCompleteKeys = _ramda2.default.union(completeKeys, [key]);\n      var done = !(0, _utils.findNextKey)(this.keys, newCompleteKeys);\n      this.setState({ completeKeys: newCompleteKeys });\n      if (!done) {\n        this.setState({ points: newPoints });\n      } else {\n        this.endTime = new Date().getTime();\n        completeAction({ duration: this.endTime - this.startTime, points: newPoints });\n      }\n    }\n  }, {\n    key: 'handleTab',\n    value: function handleTab(lensState, originalValue, key) {\n      var points = this.state.points;\n\n      var newState = _ramda2.default.set(lensState, originalValue, this.state);\n      this.setState(newState);\n      this.completeWord(points, key);\n    }\n  }, {\n    key: 'onKeyPressAction',\n    value: function onKeyPressAction(e, key) {\n      var _state$missingWords$k = this.state.missingWords[key],\n          original = _state$missingWords$k.original,\n          value = _state$missingWords$k.value;\n      var _state2 = this.state,\n          points = _state2.points,\n          completeKeys = _state2.completeKeys;\n      var keypressAction = this.props.keypressAction;\n\n      var originalChars = (0, _chars2.default)(original);\n      var valueChars = (0, _chars2.default)(value);\n      var currentIdx = valueChars.length === 0 ? 0 : valueChars.length;\n      var lensState = _ramda2.default.lensPath(['missingWords', key, 'value']);\n\n      if (String.fromCharCode(e.which).toLowerCase() === originalChars[currentIdx].toLowerCase()) {\n        this.setState(_ramda2.default.set(lensState, '' + value + originalChars[currentIdx], this.state));\n        if (currentIdx === originalChars.length - 1) {\n          this.completeWord(points + 1, key);\n        }\n      }\n      keypressAction(e);\n    }\n  }, {\n    key: 'onKeyDownAction',\n    value: function onKeyDownAction(e, key) {\n      var keypressAction = this.props.keypressAction;\n      var _state$missingWords$k2 = this.state.missingWords[key],\n          original = _state$missingWords$k2.original,\n          value = _state$missingWords$k2.value;\n\n      var lensState = _ramda2.default.lensPath(['missingWords', key, 'value']);\n      if (e.keyCode === 9) {\n        this.handleTab(lensState, original, key);\n        e.preventDefault();\n      }\n      keypressAction(e);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var mapIndex = _ramda2.default.addIndex(_ramda2.default.map);\n      var _state3 = this.state,\n          missingWords = _state3.missingWords,\n          tokens = _state3.tokens;\n\n      if (!missingWords) return null;\n      return _react2.default.createElement(\n        'div',\n        { className: this.props.className },\n        mapIndex(function (token, idx) {\n          var k = idx + '-' + token;\n          if (missingWords[k]) {\n            return _react2.default.createElement(\n              'span',\n              { className: 'missing-word', key: k },\n              _react2.default.createElement('input', {\n                ref: function ref(input) {\n                  return _this3.refs = _ramda2.default.merge(_this3.refs, _defineProperty({}, k, input));\n                },\n                id: k,\n                value: missingWords[k].value,\n                onKeyPress: function onKeyPress(e) {\n                  return _this3.onKeyPressAction(e, k);\n                },\n                onKeyDown: function onKeyDown(e) {\n                  return _this3.onKeyDownAction(e, k);\n                }\n              }),\n              _react2.default.createElement(\n                'label',\n                { htmlFor: k },\n                mapIndex(function (char, idx) {\n                  var valueChar = (0, _chars2.default)(missingWords[k].value)[idx];\n                  return valueChar || _react2.default.createElement('i', { key: idx, className: 'dot' });\n                }, (0, _chars2.default)(missingWords[k].original))\n              ),\n              '\\xA0'\n            );\n          } else {\n            return token + ' ';\n          }\n        }, tokens)\n      );\n    }\n  }]);\n\n  return ReactFill;\n}(_react2.default.Component);\n\nexports.default = ReactFill;\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/ReactFill.js\n// module id = 1\n// module chunks = 0\n\n//# sourceURL=webpack:///./src/ReactFill.js?")},function(module,exports){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n//////////////////\n// WEBPACK FOOTER\n// external "react"\n// module id = 2\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%22react%22?')},function(module,exports){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n//////////////////\n// WEBPACK FOOTER\n// external "voca/chars"\n// module id = 3\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%22voca/chars%22?')},function(module,exports){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n//////////////////\n// WEBPACK FOOTER\n// external "voca/words"\n// module id = 4\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%22voca/words%22?')},function(module,exports){eval("// Source: http://jsfiddle.net/vWx8V/\n// http://stackoverflow.com/questions/5603195/full-list-of-javascript-keycodes\n\n/**\n * Conenience method returns corresponding value for given keyName or keyCode.\n *\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Mixed}\n * @api public\n */\n\nexports = module.exports = function(searchInput) {\n  // Keyboard Events\n  if (searchInput && 'object' === typeof searchInput) {\n    var hasKeyCode = searchInput.which || searchInput.keyCode || searchInput.charCode\n    if (hasKeyCode) searchInput = hasKeyCode\n  }\n\n  // Numbers\n  if ('number' === typeof searchInput) return names[searchInput]\n\n  // Everything else (cast to string)\n  var search = String(searchInput)\n\n  // check codes\n  var foundNamedKey = codes[search.toLowerCase()]\n  if (foundNamedKey) return foundNamedKey\n\n  // check aliases\n  var foundNamedKey = aliases[search.toLowerCase()]\n  if (foundNamedKey) return foundNamedKey\n\n  // weird character?\n  if (search.length === 1) return search.charCodeAt(0)\n\n  return undefined\n}\n\n/**\n * Get by name\n *\n *   exports.code['enter'] // => 13\n */\n\nvar codes = exports.code = exports.codes = {\n  'backspace': 8,\n  'tab': 9,\n  'enter': 13,\n  'shift': 16,\n  'ctrl': 17,\n  'alt': 18,\n  'pause/break': 19,\n  'caps lock': 20,\n  'esc': 27,\n  'space': 32,\n  'page up': 33,\n  'page down': 34,\n  'end': 35,\n  'home': 36,\n  'left': 37,\n  'up': 38,\n  'right': 39,\n  'down': 40,\n  'insert': 45,\n  'delete': 46,\n  'command': 91,\n  'left command': 91,\n  'right command': 93,\n  'numpad *': 106,\n  'numpad +': 107,\n  'numpad -': 109,\n  'numpad .': 110,\n  'numpad /': 111,\n  'num lock': 144,\n  'scroll lock': 145,\n  'my computer': 182,\n  'my calculator': 183,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  \"'\": 222\n}\n\n// Helper aliases\n\nvar aliases = exports.aliases = {\n  'windows': 91,\n  '⇧': 16,\n  '⌥': 18,\n  '⌃': 17,\n  '⌘': 91,\n  'ctl': 17,\n  'control': 17,\n  'option': 18,\n  'pause': 19,\n  'break': 19,\n  'caps': 20,\n  'return': 13,\n  'escape': 27,\n  'spc': 32,\n  'pgup': 33,\n  'pgdn': 34,\n  'ins': 45,\n  'del': 46,\n  'cmd': 91\n}\n\n\n/*!\n * Programatically add the following\n */\n\n// lower case chars\nfor (i = 97; i < 123; i++) codes[String.fromCharCode(i)] = i - 32\n\n// numbers\nfor (var i = 48; i < 58; i++) codes[i - 48] = i\n\n// function keys\nfor (i = 1; i < 13; i++) codes['f'+i] = i + 111\n\n// numpad keys\nfor (i = 0; i < 10; i++) codes['numpad '+i] = i + 96\n\n/**\n * Get by code\n *\n *   exports.name[13] // => 'Enter'\n */\n\nvar names = exports.names = exports.title = {} // title for backward compat\n\n// Create reverse mapping\nfor (i in codes) names[codes[i]] = i\n\n// Add aliases\nfor (var alias in aliases) {\n  codes[alias] = aliases[alias]\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/keycode/index.js\n// module id = 5\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/keycode/index.js?")},function(module,exports,__webpack_require__){"use strict";eval("\n\nvar keys = {\n  'ctrl': 17,\n  'control': 17,\n  'alt': 18,\n  'option': 18,\n  'shift': 16,\n  'windows': 91,\n  'command': 91,\n  'esc': 27,\n  'escape': 27,\n  '`': 192,\n  '-': 189,\n  '=': 187,\n  'backspace': 8,\n  'tab': 9,\n  '\\\\': 220,\n  '[': 219,\n  ']': 221,\n  ';': 186,\n  '\\'': 222,\n  'enter': 13,\n  'return': 13,\n  ',': 188,\n  '.': 190,\n  '/': 191,\n  'space': 32,\n  'pause': 19,\n  'break': 19,\n  'insert': 45,\n  'delete': 46,\n  'home': 36,\n  'end': 35,\n  'pageup': 33,\n  'pagedown': 34,\n  'left': 37,\n  'up': 38,\n  'right': 39,\n  'down': 40,\n  'capslock': 20,\n  'numlock': 144,\n  'scrolllock': 145\n};\n\nfor (var f = 1; f < 20; f++) {\n  keys['f' + f] = 111 + f;\n}\n\nmodule.exports = function (input) {\n  if (typeof input === 'string') return code(input);\n  if (typeof input === 'number') return key(input);\n};\n\nfunction code (input) {\n  var code = keys[input.toLowerCase()];\n  if (code !== undefined) {\n    return code;\n  }\n\n  if (input.length === 1) {\n    return input.toUpperCase().charCodeAt(0);\n  }\n\n  return undefined;\n}\n\n\nfunction key(input) {\n  for (var k in keys) {\n    if (keys.hasOwnProperty(k)) {\n      if (keys[k] === input) return k;\n    }\n  }\n\n  return String.fromCharCode(input).toLowerCase();\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/keycodes/index.js\n// module id = 6\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/keycodes/index.js?")},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.findNextKey = exports.getRandoms = undefined;\n\nvar _ramda = __webpack_require__(0);\n\nvar _ramda2 = _interopRequireDefault(_ramda);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar getRandoms = exports.getRandoms = function getRandoms(nbRandoms, end) {\n  var acc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n  var number = Math.floor(Math.random() * end);\n  var foundNumber = _ramda2.default.find(function (n) {\n    return n === number;\n  }, acc);\n  if (nbRandoms === 0) return _ramda2.default.sort(function (a, b) {\n    return a - b;\n  }, acc);\n  if (foundNumber === undefined) return getRandoms(nbRandoms - 1, end, _ramda2.default.union(acc, [number]));\n  return getRandoms(nbRandoms, end, acc);\n};\n\nvar findNextKey = exports.findNextKey = function findNextKey(allKeys, completeKeys) {\n  var differenceWithCompleteKeys = _ramda2.default.difference(allKeys, completeKeys);\n  if (differenceWithCompleteKeys.length === 0) return null;\n  var nextKeyIdx = _ramda2.default.lastIndexOf(_ramda2.default.last(completeKeys), allKeys) + 1;\n  var nextKey = allKeys[nextKeyIdx];\n  if (!nextKey && differenceWithCompleteKeys.length > 0) {\n    return allKeys[0];\n  }\n  return nextKey;\n};\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/utils.js\n// module id = 7\n// module chunks = 0\n\n//# sourceURL=webpack:///./src/utils.js?')},function(module,exports){eval("// removed by extract-text-webpack-plugin\n\n//////////////////\n// WEBPACK FOOTER\n// ./scss/style.scss\n// module id = 8\n// module chunks = 0\n\n//# sourceURL=webpack:///./scss/style.scss?")}])});